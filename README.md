# NodeJS starter

## Installation

Run commands

```
cd client
npm install
npm run build
cd ..
npm install
npm start
```

Open [http://localhost:3050](http://localhost:3050)

## Особливості проекту

## Структура проекту

### `/client`

Невеликий React-додаток зі сторінками:

- Реєстрації
- Логіна
- Додавання бійців
- Вибору бійців

**Основна мета**: Демонстрація взаємодії клієнта з сервером.  
**Перегляд запитів**: Вкладка `Network` в Chrome Dev Tools.

### `/config`

Конфігурація БД. База даних реалізована у файлі `database.json`.

### `/middlewares`

Проміжні функції, що виконуються перед контролерами (з папки `routes`).

### `/repositories`

Класи для роботи з БД (патерн **Repository**).  
[Детальніше про патерн Repository](https://docs.microsoft.com/en-us/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/repository-pattern)

### `/routes`

Контролери (точки входу для запитів).

### `/services`

Класи з бізнес-логікою.  
**Важливо**:

- Контролери мають залишатися "чистими"
- Вся бізнес-логіка реалізується у сервісах

### `/models`

Моделі сутностей (формат зберігання в БД).

### `index.js`

Точка входу та конфігурація сервера.

---

## Завдання: REST API для сутностей

### Користувач (`USER`)

| Метод  | Шлях             | Дія            |
| ------ | ---------------- | -------------- |
| GET    | `/api/users`     | Отримати всіх  |
| GET    | `/api/users/:id` | Отримати за ID |
| POST   | `/api/users`     | Створити       |
| PATCH  | `/api/users/:id` | Оновити        |
| DELETE | `/api/users/:id` | Видалити       |

### Боець (`FIGHTER`)

| Метод  | Шлях                | Дія            |
| ------ | ------------------- | -------------- |
| GET    | `/api/fighters`     | Отримати всіх  |
| GET    | `/api/fighters/:id` | Отримати за ID |
| POST   | `/api/fighters`     | Створити       |
| PATCH  | `/api/fighters/:id` | Оновити        |
| DELETE | `/api/fighters/:id` | Видалити       |

---

## Вимоги до валідації

### Загальні правила

1. **ID у тілі запиту**: Заборонено
2. **Сторонні поля**: Помилка (лише властивості з моделей)
3. **Оновлення**: Хоча б одне поле має бути присутнє

### Користувач (`POST`)

- **Обов'язкові**: всі поля (крім `id`)
- **Опціональні**: відсутні

### Боець (`POST`)

- **Обов'язкові**: всі поля (крім `health` та `id`)
- **Опціональні**: `health`

---

## Валідація полів

| Поле       | Вимоги                      |
| ---------- | --------------------------- |
| `email`    | Тільки Gmail (`@gmail.com`) |
| `phone`    | Формат: `+380XXXXXXXXX`     |
| `power`    | Число (1-100)               |
| `defense`  | Число (1-10)                |
| `health`   | Число (80-120), дефолт: 85  |
| `password` | Рядок (мін. 4 символи)      |

**Примітка**: Використання сторонніх бібліотек для валідації заборонено.

---

## Обробка відповідей (`response.middleware`)

| Статус | Відповідь (JSON)                | Умови                     |
| ------ | ------------------------------- | ------------------------- |
| 200    | `{ data: ... }`                 | Успішний запит            |
| 400    | `{ error: true, message: ... }` | Помилка валідації/обробки |
| 404    | `{ error: true, message: ... }` | Дані не знайдено          |

**Приклади повідомлень про помилки**:

- `User not found`
- `User entity to create isn’t valid`

---

## Унікальність даних

Заборонено в БД:

- Користувачі з однаковим `email` (case-insensitive)
- Користувачі з однаковим `phone`
- Бійці з однаковим `name` (case-insensitive)

---

## Архітектурні вимоги

1. **`repositories`**: Робота з БД
2. **`services`**: Бізнес-логіка
3. **`routes`**: Обробка запитів/відповідей

---

## Додаткове завдання

1. Реалізувати функціонал битв (з попереднього завдання)
2. Зберігати історію битв
3. Додати перегляд історії битв
